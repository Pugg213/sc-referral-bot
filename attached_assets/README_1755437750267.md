# SC Referral Bot — "Ref Capsules" (Replit-ready)

Телеграм-бот с реферальной механикой «капсул», анти-накруткой, гейтом подписки (канал+чат) и офчейн-наградами.
Ончейна нет — накопление SC в офчейн-балансе, выплаты батчем админом.

## Быстрый старт (Replit)
1) Создай новый **Replit (Python)** и загрузи этот архив.
2) В **Secrets** добавь переменные окружения:
   - `BOT_TOKEN` — токен бота
   - `REQUIRED_CHANNEL_ID` — ID канала (`@username` или `-100...`) — бот должен быть АДМИНОМ канала
   - `REQUIRED_GROUP_ID` — ID группы (`-100...`) — бот должен быть участником
   - (опц.) `CHANNEL_LINK` — ссылка-приглашение в канал, если приватный
   - (опц.) `GROUP_LINK` — ссылка-приглашение в группу, если приватная
3) Консоль: `pip install -r requirements.txt`
4) Запуск: `python main.py`

## Команды
Пользователь:
- `/start` — онбординг, капча, гейт подписки, реф-ссылка
- `/check` — повторная проверка подписки
- `/me` — профиль
- `/open` — открыть капсулу (рандом награда)
- `/top` — лидерборд
- `/rules` — правила
- `/wallet <TON_ADDRESS>` — привязка адреса

Админ:
- `/stats` — краткая сводка
- `/payout <@user|id> <amount>` — списать со счёта и отметить выплату
- `/risk_rules` — текущие пороги рисков
- `/ban <@user|id>` / `/unban <@user|id>` — мягкий бан (запрет наград)

## Что внутри
- **Гейт**: обязательная подписка на канал и вступление в чат.
- **Анти-накрутка**: капча с замером, скоринг рисков, карантин, отложенная валидация рефералов.
- **Капсулы**: конфигурируемые вероятности и призы (`app/config.py`).
- **Офчейн-баланс**: SC-копилка в БД, выплаты — через админ-команды

## Важно
Это каркас (skeleton) под ваш SC-проект — минимально рабочий и легко расширяемый.
